"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.island-reversal-signal"],{494:(e,t,i)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t,i){return t=s(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,i||[],s(e).constructor):t.apply(e,i))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}i.r(t),i.d(t,{default:()=>h});const h=function(e){function t(e,i,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=o(this,t,[e,i,r])).title="Island Reversal",a.shorttitle="Island",a.precision=2,a.minGapSize=void 0!==i.minGapSize?i.minGapSize:.3,a.maxIslandBars=void 0!==i.maxIslandBars?i.maxIslandBars:10,a.minIslandBars=void 0!==i.minIslandBars?i.minIslandBars:1,a.showLabels=void 0===i.showLabels||i.showLabels,a.bullishColor=i.bullishColor||"#00E676",a.bearishColor=i.bearishColor||"#FF1744",a.panelType="main",a.plots=[{dataKey:"signals",colorKey:"bullishColor",title:"Island Reversal"}],a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),i=t,n=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"minGapSize",label:"Min Gap Size %",type:"number",default:.3,min:.1,max:1,step:.1},{key:"minIslandBars",label:"Min Island Bars",type:"number",default:1,min:1,max:5,step:1},{key:"maxIslandBars",label:"Max Island Bars",type:"number",default:10,min:5,max:20,step:1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}],style:[{key:"bullishColor",label:"Bullish Island",type:"color",default:"#00E676"},{key:"bearishColor",label:"Bearish Island",type:"color",default:"#FF1744"}]}}}],(r=[{key:"calculate",value:function(){for(var e=this.engine.data,t=e.map(function(){return null}),i=this.maxIslandBars+2;i<e.length;i++)for(var r=this.minIslandBars;r<=this.maxIslandBars;r++){var a=i-r-1,n=i-r,o=i-1,l=i;if(!(a<0)){var s=e[a],u=e[n],h=e[o],c=e[l],f=u.low>s.high,d=c.high<h.low;if(f&&d){var b=(u.low-s.high)/s.high*100,p=(h.low-c.high)/h.low*100;if(b>=this.minGapSize&&p>=this.minGapSize){t[i]||(t[i]={type:"bearish",price:c.high,islandLength:r,gapSize:(b+p)/2});break}}var y=u.high<s.low,v=c.low>h.high;if(y&&v){var m=(s.low-u.high)/s.low*100,g=(c.low-h.high)/h.high*100;if(m>=this.minGapSize&&g>=this.minGapSize){t[i]||(t[i]={type:"bullish",price:c.low,islandLength:r,gapSize:(m+g)/2});break}}}}this.data={signals:t}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var i=e.ctx,r=e.getDpr(),a=this.engine,n=a.data;if(this.data.signals&&this.data.signals.length===n.length||(this.calculate(),this.data&&this.data.signals)){i.save(),i.scale(r,r);for(var o=a.visibleRange,l=o.start;l<o.end;l++)if(!(l<0||l>=this.data.signals.length)){var s=this.data.signals[l];if(s){var u=a.indexToX(l)+a.candleWidth/2,h=a.priceToY(s.price);"bullish"===s.type?(this.drawBullishIsland(i,u,h),this.showLabels&&this.drawLabel(i,u,h,"IR↑",this.bullishColor)):"bearish"===s.type&&(this.drawBearishIsland(i,u,h),this.showLabels&&this.drawLabel(i,u,h,"IR↓",this.bearishColor))}}i.restore()}}}},{key:"drawBullishIsland",value:function(e,t,i){var r=20;e.strokeStyle=this.bullishColor,e.fillStyle=this.bullishColor,e.lineWidth=2,e.strokeRect(t-8,i+r+2,16,6),e.beginPath(),e.moveTo(t-10,i+r),e.quadraticCurveTo(t-5,i+r-2,t,i+r),e.quadraticCurveTo(t+5,i+r+2,t+10,i+r),e.stroke(),e.beginPath(),e.moveTo(t-10,i+r+10),e.quadraticCurveTo(t-5,i+r+12,t,i+r+10),e.quadraticCurveTo(t+5,i+r+8,t+10,i+r+10),e.stroke(),e.beginPath(),e.moveTo(t+12,i+r-5),e.lineTo(t+9,i+r-2),e.lineTo(t+15,i+r-2),e.closePath(),e.fill()}},{key:"drawBearishIsland",value:function(e,t,i){var r=20;e.strokeStyle=this.bearishColor,e.fillStyle=this.bearishColor,e.lineWidth=2,e.strokeRect(t-8,i-r-8,16,6),e.beginPath(),e.moveTo(t-10,i-r),e.quadraticCurveTo(t-5,i-r+2,t,i-r),e.quadraticCurveTo(t+5,i-r-2,t+10,i-r),e.stroke(),e.beginPath(),e.moveTo(t-10,i-r-10),e.quadraticCurveTo(t-5,i-r-12,t,i-r-10),e.quadraticCurveTo(t+5,i-r-8,t+10,i-r-10),e.stroke(),e.beginPath(),e.moveTo(t+12,i-r+5),e.lineTo(t+9,i-r+2),e.lineTo(t+15,i-r+2),e.closePath(),e.fill()}},{key:"drawLabel",value:function(e,t,i,r,a){e.font="bold 9px sans-serif",e.fillStyle=a,e.textAlign="center";var n=r.includes("↑")?40:-35;e.fillText(r,t,i+n)}}])&&a(i.prototype,r),n&&a(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(i(8018).A)}}]);