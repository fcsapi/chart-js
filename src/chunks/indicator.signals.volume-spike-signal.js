"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.volume-spike-signal"],{2647:(e,t,o)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,o){return t=s(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,o||[],s(e).constructor):t.apply(e,o))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}o.r(t),o.d(t,{default:()=>c});const c=function(e){function t(e,o,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,t,[e,o,r])).title="Volume Spike Signal",n.shorttitle="Vol Spike",n.precision=2,n.length=void 0!==o.length?o.length:20,n.threshold=void 0!==o.threshold?o.threshold:2,n.showLabels=void 0!==o.showLabels&&o.showLabels,n.buyColor=o.buyColor||"#2962FF",n.sellColor=o.sellColor||"#FF6D00",n.panelType="main",n.plots=[{dataKey:"signals",colorKey:"buyColor",title:"Volume Spikes"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),o=t,l=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"length",label:"Average Length",type:"number",default:20,min:5,max:100,step:1},{key:"threshold",label:"Spike Multiplier",type:"number",default:2,min:1.5,max:5,step:.1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!1}],style:[{key:"buyColor",label:"Bullish Spike",type:"color",default:"#2962FF"},{key:"sellColor",label:"Bearish Spike",type:"color",default:"#FF6D00"}]}}}],(r=[{key:"calculate",value:function(){var e=this,t=this.engine.data,o=this.engine.dataManager,r=t.map(function(e){return e.volume||0}),n=o.calculateSMAFromArray(r,this.length),l=t.map(function(t,o){if(o<e.length||!n[o]||!t.volume)return null;if(t.volume>n[o]*e.threshold){var r=t.close>t.open;return{type:r?"buy":"sell",price:r?t.low:t.high,volume:t.volume,avgVolume:n[o]}}return null});this.data={signals:l,avgVolume:n}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var o=e.ctx,r=e.getDpr(),n=this.engine,l=n.data;if(this.data.signals&&this.data.signals.length===l.length||(this.calculate(),this.data&&this.data.signals)){o.save(),o.scale(r,r);for(var i=n.visibleRange,a=i.start;a<i.end;a++)if(!(a<0||a>=this.data.signals.length)){var s=this.data.signals[a];if(s){var u=n.indexToX(a)+n.candleWidth/2,c=n.priceToY(s.price);"buy"===s.type?(this.drawVolumeSpike(o,u,c,this.buyColor),this.showLabels&&this.drawLabel(o,u,c,"VOL",this.buyColor)):"sell"===s.type&&(this.drawVolumeSpike(o,u,c,this.sellColor),this.showLabels&&this.drawLabel(o,u,c,"VOL",this.sellColor))}}o.restore()}}}},{key:"drawVolumeSpike",value:function(e,t,o,r){e.fillStyle=r,e.globalAlpha=.8,e.beginPath(),e.moveTo(t,o-6),e.lineTo(t+6,o),e.lineTo(t,o+6),e.lineTo(t-6,o),e.closePath(),e.fill(),e.globalAlpha=1}},{key:"drawLabel",value:function(e,t,o,r,n){e.font="bold 9px sans-serif",e.fillStyle=n,e.textAlign="center",e.fillText(r,t,o-12)}}])&&n(o.prototype,r),l&&n(o,l),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r,l}(o(8018).A)}}]);