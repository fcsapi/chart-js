"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.trend-signal"],{1885:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function l(e,t,n){return t=u(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}n.r(t),n.d(t,{default:()=>c});const c=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=l(this,t,[e,n,r])).title="Trend Signal",o.shorttitle="Trend",o.precision=2,o.atrLength=void 0!==n.atrLength?n.atrLength:10,o.multiplier=void 0!==n.multiplier?n.multiplier:3,o.linewidth=void 0!==n.linewidth?n.linewidth:2,o.showArrows=void 0===n.showArrows||n.showArrows,o.upColor=n.upColor||"#26A69A",o.downColor=n.downColor||"#EF5350",o.panelType="main",o.plots=[{dataKey:"trendLine",colorKey:"upColor",title:"Trend"}],o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(t,e),n=t,i=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"atrLength",label:"ATR Length",type:"number",default:10,min:1,max:100,step:1},{key:"multiplier",label:"Multiplier",type:"number",default:3,min:.5,max:10,step:.5},{key:"showArrows",label:"Show Change Arrows",type:"checkbox",default:!0},{key:"linewidth",label:"Line Width",type:"number",default:2,min:1,max:10,step:1}],style:[{key:"upColor",label:"Up Trend",type:"color",default:"#26A69A"},{key:"downColor",label:"Down Trend",type:"color",default:"#EF5350"}]}}}],(r=[{key:"calculate",value:function(){for(var e=this,t=this.engine.data,n=this.engine.dataManager.calculateATR(t,this.atrLength),r=t.map(function(t,r){return null===n[r]?null:(t.high+t.low)/2+e.multiplier*n[r]}),o=t.map(function(t,r){return null===n[r]?null:(t.high+t.low)/2-e.multiplier*n[r]}),i=[],l=[],a=0;a<t.length;a++)null!==r[a]?(a>0&&null!==i[a-1]?i.push(r[a]<i[a-1]||t[a-1].close>i[a-1]?r[a]:i[a-1]):i.push(r[a]),a>0&&null!==l[a-1]?l.push(o[a]>l[a-1]||t[a-1].close<l[a-1]?o[a]:l[a-1]):l.push(o[a])):(i.push(null),l.push(null));for(var u=[],s=[],c=[],h=0;h<t.length;h++)if(null!==i[h]){var p=void 0;p=0===h?1:1===(u[h-1]||1)?t[h].close<=l[h]?-1:1:t[h].close>=i[h]?1:-1,u.push(p),s.push(1===p?l[h]:i[h]),h>0&&null!==u[h-1]&&u[h]!==u[h-1]?1===p?c.push({type:"buy",price:t[h].low}):c.push({type:"sell",price:t[h].high}):c.push(null)}else u.push(null),s.push(null),c.push(null);this.data={trendLine:s,trend:u,signals:c}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var n=e.ctx,r=e.getDpr(),o=this.engine,i=o.data;if(this.data.trendLine&&this.data.trendLine.length===i.length||(this.calculate(),this.data&&this.data.trendLine)){n.save(),n.scale(r,r);var l=o.visibleRange;if(this.drawTrendLine(n,l,o),this.showArrows)for(var a=l.start;a<l.end;a++)if(!(a<0||a>=this.data.signals.length)){var u=this.data.signals[a];if(u){var s=o.indexToX(a)+o.candleWidth/2,c=o.priceToY(u.price);"buy"===u.type?this.drawBuyArrow(n,s,c):"sell"===u.type&&this.drawSellArrow(n,s,c)}}n.restore()}}}},{key:"drawTrendLine",value:function(e,t,n){e.lineWidth=this.linewidth,e.beginPath();for(var r=!1,o=null,i=t.start;i<t.end;i++)if(!(i<0||i>=this.data.trendLine.length)){var l=this.data.trendLine[i],a=this.data.trend[i];if(null!==l&&null!==a){var u=n.indexToX(i)+n.candleWidth/2,s=n.priceToY(l),c=1===a?this.upColor:this.downColor;r&&c===o?e.lineTo(u,s):(r&&(e.stroke(),e.beginPath()),e.strokeStyle=c,e.moveTo(u,s),r=!0,o=c)}else r=!1}r&&e.stroke()}},{key:"drawBuyArrow",value:function(e,t,n){e.fillStyle=this.upColor,e.beginPath(),e.moveTo(t,n+12),e.lineTo(t-6,n+12+6),e.lineTo(t+6,n+12+6),e.closePath(),e.fill()}},{key:"drawSellArrow",value:function(e,t,n){e.fillStyle=this.downColor,e.beginPath(),e.moveTo(t,n-12),e.lineTo(t-6,n-12-6),e.lineTo(t+6,n-12-6),e.closePath(),e.fill()}}])&&o(n.prototype,r),i&&o(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(n(8018).A)}}]);