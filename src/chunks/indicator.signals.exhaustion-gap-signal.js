"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.exhaustion-gap-signal"],{8927:(e,t,i)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t,i){return t=s(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,i||[],s(e).constructor):t.apply(e,i))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}i.r(t),i.d(t,{default:()=>h});const h=function(e){function t(e,i,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=a(this,t,[e,i,r])).title="Exhaustion Gap",o.shorttitle="Exh Gap",o.precision=2,o.minGapSize=void 0!==i.minGapSize?i.minGapSize:.3,o.minVolumeIncrease=void 0!==i.minVolumeIncrease?i.minVolumeIncrease:1.5,o.reversalConfirm=void 0!==i.reversalConfirm?i.reversalConfirm:3,o.showLabels=void 0===i.showLabels||i.showLabels,o.bullishColor=i.bullishColor||"#00BCD4",o.bearishColor=i.bearishColor||"#FF5722",o.panelType="main",o.plots=[{dataKey:"signals",colorKey:"bullishColor",title:"Exhaustion Gap"}],o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),i=t,n=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"minGapSize",label:"Min Gap Size %",type:"number",default:.3,min:.1,max:2,step:.1},{key:"minVolumeIncrease",label:"Min Volume Increase",type:"number",default:1.5,min:1,max:3,step:.1},{key:"reversalConfirm",label:"Reversal Confirm Bars",type:"number",default:3,min:1,max:10,step:1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}],style:[{key:"bullishColor",label:"Bullish Exhaustion",type:"color",default:"#00BCD4"},{key:"bearishColor",label:"Bearish Exhaustion",type:"color",default:"#FF5722"}]}}}],(r=[{key:"calculate",value:function(){var e=this,t=this.engine.data,i=t.map(function(i,r){if(r<5)return null;var o=t[r-1],n=i,a=(n.low-o.high)/o.close*100,l=(o.low-n.high)/o.close*100,s=a>e.minGapSize,u=l>e.minGapSize;if(!s&&!u)return null;var h=!0;if(n.volume&&o.volume&&(h=n.volume>o.volume*e.minVolumeIncrease),!h)return null;var c=!1,f=Math.min(r+e.reversalConfirm,t.length-1);if(s){n.high;for(var b=r+1;b<=f;b++)if(t[b].close<n.close){c=!0;break}if(c)return{type:"bearish",price:n.high,gapSize:a}}else if(u){n.low;for(var p=r+1;p<=f;p++)if(t[p].close>n.close){c=!0;break}if(c)return{type:"bullish",price:n.low,gapSize:Math.abs(l)}}return null});this.data={signals:i}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var i=e.ctx,r=e.getDpr(),o=this.engine,n=o.data;if(this.data.signals&&this.data.signals.length===n.length||(this.calculate(),this.data&&this.data.signals)){i.save(),i.scale(r,r);for(var a=o.visibleRange,l=a.start;l<a.end;l++)if(!(l<0||l>=this.data.signals.length)){var s=this.data.signals[l];if(s){var u=o.indexToX(l)+o.candleWidth/2,h=o.priceToY(s.price);"bullish"===s.type?(this.drawBullishExhaustion(i,u,h),this.showLabels&&this.drawLabel(i,u,h,"EX+",this.bullishColor)):"bearish"===s.type&&(this.drawBearishExhaustion(i,u,h),this.showLabels&&this.drawLabel(i,u,h,"EX-",this.bearishColor))}}i.restore()}}}},{key:"drawBullishExhaustion",value:function(e,t,i){var r=20;e.strokeStyle=this.bullishColor,e.fillStyle=this.bullishColor,e.lineWidth=2,e.setLineDash([3,3]),e.beginPath(),e.moveTo(t,i+r),e.lineTo(t,i+r+10),e.stroke(),e.setLineDash([]),e.beginPath(),e.arc(t,i+r+15,5,Math.PI,0,!1),e.stroke(),e.beginPath(),e.moveTo(t+5,i+r+15),e.lineTo(t+2,i+r+12),e.lineTo(t+2,i+r+18),e.closePath(),e.fill()}},{key:"drawBearishExhaustion",value:function(e,t,i){var r=20;e.strokeStyle=this.bearishColor,e.fillStyle=this.bearishColor,e.lineWidth=2,e.setLineDash([3,3]),e.beginPath(),e.moveTo(t,i-r),e.lineTo(t,i-r-10),e.stroke(),e.setLineDash([]),e.beginPath(),e.arc(t,i-r-15,5,0,Math.PI,!1),e.stroke(),e.beginPath(),e.moveTo(t-5,i-r-15),e.lineTo(t-2,i-r-12),e.lineTo(t-2,i-r-18),e.closePath(),e.fill()}},{key:"drawLabel",value:function(e,t,i,r,o){e.font="bold 8px sans-serif",e.fillStyle=o,e.textAlign="center";var n="EX+"===r?45:-40;e.fillText(r,t,i+n)}}])&&o(i.prototype,r),n&&o(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(i(8018).A)}}]);