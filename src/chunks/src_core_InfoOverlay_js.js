"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["src_core_InfoOverlay_js"],{3408:(e,t,a)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}a.r(t),a.d(t,{default:()=>l});const l=function(){return e=function e(t){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.engine=t,this.container=null,this.hoveredCandle=null,this.hoveredIndex=null,this.ticker="",this.period="",this.exchange="",this.profileData=null,this.lastHTML="",this.cachedValues={rawOpen:null,rawHigh:null,rawLow:null,rawClose:null,formattedOpen:"",formattedHigh:"",formattedLow:"",formattedClose:"",formattedChange:"",index:"",isSmall:!1,isVerySmall:!1},this.chartWidth=800,this.updateDebounceTimer=null,this.updateDebounceDelay=35,this.createOverlay(),window.addEventListener("resize",function(){a.engine.chartArea&&(a.chartWidth=a.engine.chartArea.offsetWidth)})},t=[{key:"createOverlay",value:function(){var e=this;this.wrapper=document.createElement("div"),this.wrapper.className="fcsapi-overlay-wrapper",this.engine.chartArea.appendChild(this.wrapper),this.container=document.createElement("div"),this.container.className="fcsapi-info-overlay",this.container.style.pointerEvents="auto",this.wrapper.appendChild(this.container);var t=document.createElement("div");t.className="fcsapi-info-line",this.elements={symbol:this.createSpan("fcsapi-info-symbol fcsapi-symbol-clickable",""),period:this.createSpan("fcsapi-info-period",""),exchange:this.createSpan("fcsapi-info-exchange",""),marketStatus:this.createSpan("fcsapi-market-status","●"),separator:this.createSpan("fcsapi-info-separator","•"),index:this.createSpan("fcsapi-info-index","0"),labelO:this.createSpan("fcsapi-info-label","O"),valueO:this.createSpan("fcsapi-info-value",""),labelH:this.createSpan("fcsapi-info-label","H"),valueH:this.createSpan("fcsapi-info-value",""),labelL:this.createSpan("fcsapi-info-label","L"),valueL:this.createSpan("fcsapi-info-value",""),labelC:this.createSpan("fcsapi-info-label","C"),valueC:this.createSpan("fcsapi-info-value",""),change:this.createSpan("","")},t.appendChild(this.elements.symbol),t.appendChild(this.elements.period),t.appendChild(this.elements.exchange),t.appendChild(this.elements.marketStatus),t.appendChild(this.elements.index),t.appendChild(this.elements.separator),t.appendChild(this.elements.labelO),t.appendChild(this.elements.valueO),t.appendChild(this.elements.labelH),t.appendChild(this.elements.valueH),t.appendChild(this.elements.labelL),t.appendChild(this.elements.valueL),t.appendChild(this.elements.labelC),t.appendChild(this.elements.valueC),t.appendChild(this.elements.change),this.container.appendChild(t),this.elements.symbol.addEventListener("click",function(){e.openSearchModal()}),this.elements.symbol.setAttribute("data-tooltip-title","Click to search symbols"),this.elements.symbol.setAttribute("data-tooltip-placement","bottom"),this.engine.chartArea&&(this.chartWidth=this.engine.chartArea.offsetWidth)}},{key:"createSpan",value:function(e,t){var a=document.createElement("span");return e&&(a.className=e),a.textContent=t,a}},{key:"setInfo",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e&&e.includes(":")){var n=e.split(":");this.exchange=n[0],this.ticker=n[1]}else this.ticker=e||"",this.exchange="";this.period=t||"",this.symbolDisplayName=a||null,this.update()}},{key:"setProfileData",value:function(e){this.profileData=e,null!=e&&e.name&&(this.symbolDisplayName=e.name)}},{key:"setHoveredCandle",value:function(e,t){var a=this;this.hoveredCandle=e,this.hoveredIndex=t,this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=setTimeout(function(){a.update(),a.updateDebounceTimer=null},this.updateDebounceDelay)}},{key:"clearHoveredCandle",value:function(){this.hoveredCandle=null,this.hoveredIndex=null,this.updateDebounceTimer&&(clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=null),this.update()}},{key:"update",value:function(){var e,t,a,n,i;if(this.container&&this.elements)if(!1!==this.engine.showOHLCBar){this.container.style.display="";var s=this.hoveredCandle||this.getLastCandle();if(!s)return this.elements.valueO.textContent="",this.elements.valueH.textContent="",this.elements.valueL.textContent="",this.elements.valueC.textContent="",this.elements.change.textContent="",void(this.elements.index.textContent="0");var l=null!==(e=s.open)&&void 0!==e?e:s.o,o=null!==(t=s.high)&&void 0!==t?t:s.h,r=null!==(a=s.low)&&void 0!==a?a:s.l,h=null!==(n=s.close)&&void 0!==n?n:s.c;if(void 0!==l&&void 0!==o&&void 0!==r&&void 0!==h){var c=this.symbolDisplayName||(null===(i=this.profileData)||void 0===i?void 0:i.name)||this.ticker;this.elements.symbol.textContent!==c&&(this.elements.symbol.textContent=c);var d=this.period||this.engine.options.period||"";if(this.elements.period.textContent!==d&&(this.elements.period.textContent=d,this.elements.period.style.display=d?"":"none"),this.elements.exchange.textContent!==this.exchange&&(this.elements.exchange.textContent=this.exchange,this.elements.exchange.style.display=this.exchange?"":"none"),this.engine.marketSession){var u=["regular","market","pre_market","post_market"].includes(this.engine.marketSession),p=u?"fcsapi-market-open":"fcsapi-market-closed";if(this.elements.marketStatus.className!=="fcsapi-market-status ".concat(p)){this.elements.marketStatus.className="fcsapi-market-status ".concat(p);var m=u?"Market Open":"out_of_session"==this.engine.marketSession?"Market Closed":this.engine.marketSession.replace("_"," ").replace(/\b\w/g,function(e){return e.toUpperCase()});this.elements.marketStatus.title=m}this.elements.marketStatus.style.display=""}else this.elements.marketStatus.style.display="none";var f=this.engine.getRenderDataLength(),v=0;null!==this.hoveredIndex&&void 0!==this.hoveredIndex&&(v=f-1-this.hoveredIndex);var y=String(v);this.cachedValues.index!==y&&(this.elements.index.textContent=y,this.cachedValues.index=y);var C=this.chartWidth<550,g=this.chartWidth<700;if(C!==this.cachedValues.isVerySmall){this.cachedValues.isVerySmall=C;var b=!C;this.elements.labelO.style.display=b?"":"none",this.elements.valueO.style.display=b?"":"none",this.elements.labelH.style.display=b?"":"none",this.elements.valueH.style.display=b?"":"none",this.elements.labelL.style.display=b?"":"none",this.elements.valueL.style.display=b?"":"none"}this.cachedValues.isSmall=g;var w=this.cachedValues.rawOpen!==l,x=this.cachedValues.rawHigh!==o,S=this.cachedValues.rawLow!==r,k=this.cachedValues.rawClose!==h;if(w&&(this.cachedValues.rawOpen=l,this.cachedValues.formattedOpen=this.engine.formatPrice(l),this.elements.valueO.textContent=this.cachedValues.formattedOpen),x&&(this.cachedValues.rawHigh=o,this.cachedValues.formattedHigh=this.engine.formatPrice(o),this.elements.valueH.textContent=this.cachedValues.formattedHigh),S&&(this.cachedValues.rawLow=r,this.cachedValues.formattedLow=this.engine.formatPrice(r),this.elements.valueL.textContent=this.cachedValues.formattedLow),k&&(this.cachedValues.rawClose=h,this.cachedValues.formattedClose=this.engine.formatPrice(h),this.elements.valueC.textContent=this.cachedValues.formattedClose),w||k){var V,D,O=h>=l,T=this.engine.chartType||"candles",L=(null===(V=this.engine.themeManager)||void 0===V?void 0:V.getChartTypeColors(T))||{},H=(null===(D=this.engine.themeManager)||void 0===D?void 0:D.getCurrentTheme())||{},M=O?L.upColor||H.upColor||"#26a69a":L.downColor||H.downColor||"#ef5350";this.cachedValues.valueColor!==M&&(this.cachedValues.valueColor=M,this.elements.valueO.style.color=M,this.elements.valueH.style.color=M,this.elements.valueL.style.color=M,this.elements.valueC.style.color=M)}if(g)this.elements.change.style.display="none";else{if(w||k){var N,_,I=h-l,E=I/l*100,P=I>=0,A=this.engine.chartType||"candles",W=(null===(N=this.engine.themeManager)||void 0===N?void 0:N.getChartTypeColors(A))||{},j=(null===(_=this.engine.themeManager)||void 0===_?void 0:_.getCurrentTheme())||{},B=P?W.upColor||j.upColor||"#26a69a":W.downColor||j.downColor||"#ef5350",R=P?"+":"";this.elements.change.style.color=B,this.cachedValues.formattedChange="".concat(R).concat(this.engine.formatPrice(I)," (").concat(R).concat(E.toFixed(2),"%)"),this.elements.change.textContent=this.cachedValues.formattedChange}this.elements.change.style.display=""}}}else this.container.style.display="none"}},{key:"getLastCandle",value:function(){var e=this.engine.getRenderData();return e&&0!==e.length?e[e.length-1]:null}},{key:"resetColorCache",value:function(){this.cachedValues.valueColor=null}},{key:"openSearchModal",value:function(){var e=this.engine.container.id,t=document.getElementById("chartSearchModal");if(t&&(window._fcsapiSearchManager&&(window._fcsapiSearchManager.targetChartId=e),window.CustomModal)){var a=window.CustomModal.getOrCreateInstance(t);null==a||a.show()}}},{key:"destroy",value:function(){this.updateDebounceTimer&&(clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=null),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}],t&&i(e.prototype,t),a&&i(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a}()}}]);