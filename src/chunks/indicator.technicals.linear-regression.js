"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.technicals.linear-regression"],{6271:(e,t,r)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function l(e,t,r){return t=s(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,r||[],s(e).constructor):t.apply(e,r))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}r.r(t),r.d(t,{default:()=>u});const u=function(e){function t(e,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=l(this,t,[e,r,o])).title="Linear Regression Channel",i.shorttitle="LinReg",i.precision=2,i.length=void 0!==r.length?r.length:100,i.src=void 0!==r.src?r.src:"close",i.deviations=void 0!==r.deviations?r.deviations:2,i.linewidth=void 0!==r.linewidth?r.linewidth:2,i.lineColor=r.lineColor||"#2962FF",i.upperColor=r.upperColor||"#26A69A",i.lowerColor=r.lowerColor||"#EF5350",i.fillColor=r.fillColor||"rgba(41, 98, 255, 0.05)",i.showLine=void 0===r.showLine||r.showLine,i.showUpper=void 0===r.showUpper||r.showUpper,i.showLower=void 0===r.showLower||r.showLower,i.showFill=void 0===r.showFill||r.showFill,i.panelType="main",i.panelHeight=150,i.plots=[{dataKey:"linreg",colorKey:"lineColor",title:"LinReg"}],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),r=t,n=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"length",label:"Length",type:"number",default:100,min:2,max:500,step:1},{key:"src",label:"Source",type:"source",default:"close"},{key:"deviations",label:"Deviations",type:"number",default:2,min:.1,max:5,step:.1},{key:"linewidth",label:"Line Width",type:"number",default:2,min:1,max:5,step:1}],style:[{key:"lineColor",label:"Regression Line",type:"color",default:"#2962FF"},{key:"showLine",label:"Regression Line",type:"checkbox",default:!0},{key:"upperColor",label:"Upper Band",type:"color",default:"#26A69A"},{key:"showUpper",label:"Upper Band",type:"checkbox",default:!0},{key:"lowerColor",label:"Lower Band",type:"color",default:"#EF5350"},{key:"showLower",label:"Lower Band",type:"checkbox",default:!0},{key:"fillColor",label:"Fill",type:"color",default:"rgba(41, 98, 255, 0.05)"},{key:"showFill",label:"Fill",type:"checkbox",default:!0}]}}}],(o=[{key:"calculate",value:function(){var e=this,t=this.engine.data;if(t&&0!==t.length){for(var r=t.map(function(t){return t[e.src]}),o=[],i=[],n=[],l=0;l<t.length;l++)if(l<this.length-1)o[l]=null,i[l]=null,n[l]=null;else{for(var a=r.slice(l-this.length+1,l+1),s=a.length,c=0,u=0,h=0,f=0,p=0;p<s;p++)c+=p,u+=a[p],h+=p*a[p],f+=p*p;var d=(s*h-c*u)/(s*f-c*c),y=(u-d*c)/s,w=y+d*(s-1);o[l]=w;for(var b=0,v=0;v<s;v++){var g=y+d*v,m=a[v]-g;b+=m*m}var k=Math.sqrt(b/s);i[l]=w+this.deviations*k,n[l]=w-this.deviations*k}this.data={linreg:o,upper:i,lower:n}}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var r=e.ctx,o=e.getDpr(),i=this.engine,n=i.data;if(this.data.linreg&&this.data.linreg.length===n.length||(this.calculate(),this.data&&this.data.linreg)){r.save(),r.scale(o,o),this.showFill&&this.showUpper&&this.showLower&&this.drawFillBetweenLines(r,this.data.upper,this.data.lower,this.fillColor,i),this.showUpper&&this.drawLine(r,this.data.upper,!0,this.upperColor,1,0,0,i,t),this.showLower&&this.drawLine(r,this.data.lower,!0,this.lowerColor,1,0,0,i,t),this.showLine&&this.drawLine(r,this.data.linreg,!0,this.lineColor,this.linewidth,0,0,i,t),r.fillStyle="#d1d4dc",r.font="bold 11px sans-serif";var l=this.shorttitle;r.fillText(l,5,12),r.restore()}}}},{key:"drawLine",value:function(e,t,r,o,i,n,l,a,s){if(t&&0!==t.length){var c=a.visibleRange,u=Math.max(0,c.start),h=Math.min(t.length,c.end),f=t.slice(u,h),p=u-c.start;e.strokeStyle=o,e.lineWidth=i,e.beginPath();var d=!1;f.forEach(function(t,r){if(null!==t&&!isNaN(t)){var o=c.start+p+r,i=a.indexToX(o)+a.candleWidth/2,n=a.priceToY(t);d?e.lineTo(i,n):(e.moveTo(i,n),d=!0)}}),e.stroke()}}},{key:"drawFillBetweenLines",value:function(e,t,r,o,i){if(t&&r&&0!==t.length&&0!==r.length){var n=i.visibleRange,l=Math.max(0,n.start),a=Math.min(t.length,n.end),s=l-n.start;e.fillStyle=o,e.beginPath();for(var c=!1,u=l;u<a;u++){var h=t[u];if(null!==h&&!isNaN(h)){var f=n.start+s+(u-l),p=i.indexToX(f)+i.candleWidth/2,d=i.priceToY(h);c?e.lineTo(p,d):(e.moveTo(p,d),c=!0)}}for(var y=a-1;y>=l;y--){var w=r[y];if(null!==w&&!isNaN(w)){var b=n.start+s+(y-l),v=i.indexToX(b)+i.candleWidth/2,g=i.priceToY(w);e.lineTo(v,g)}}e.closePath(),e.fill()}}}])&&i(r.prototype,o),n&&i(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,n}(r(8018).A)}}]);