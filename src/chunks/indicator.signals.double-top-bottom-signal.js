"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.double-top-bottom-signal"],{91:(e,t,o)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function a(e,t,o){return t=s(t),function(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,o||[],s(e).constructor):t.apply(e,o))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}o.r(t),o.d(t,{default:()=>u});const u=function(e){function t(e,o,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=a(this,t,[e,o,n])).title="Double Top/Bottom",i.shorttitle="DTB",i.precision=2,i.tolerance=void 0!==o.tolerance?o.tolerance:1,i.minDistance=void 0!==o.minDistance?o.minDistance:10,i.maxDistance=void 0!==o.maxDistance?o.maxDistance:50,i.necklineBreak=void 0!==o.necklineBreak?o.necklineBreak:.2,i.showLabels=void 0===o.showLabels||o.showLabels,i.doubleTopColor=o.doubleTopColor||"#E91E63",i.doubleBottomColor=o.doubleBottomColor||"#00BCD4",i.panelType="main",i.plots=[{dataKey:"signals",colorKey:"doubleTopColor",title:"Double Top/Bottom"}],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),o=t,r=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"tolerance",label:"Price Tolerance %",type:"number",default:1,min:.3,max:3,step:.1},{key:"minDistance",label:"Min Peak Distance",type:"number",default:10,min:5,max:30,step:1},{key:"maxDistance",label:"Max Peak Distance",type:"number",default:50,min:20,max:100,step:5},{key:"necklineBreak",label:"Neckline Break %",type:"number",default:.2,min:.1,max:1,step:.1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}],style:[{key:"doubleTopColor",label:"Double Top",type:"color",default:"#E91E63"},{key:"doubleBottomColor",label:"Double Bottom",type:"color",default:"#00BCD4"}]}}}],(n=[{key:"calculate",value:function(){for(var e=this.engine.data,t=[],o=[],n=5;n<e.length-5;n++){for(var i=!0,r=1;r<=5;r++)if(e[n-r].high>=e[n].high||e[n+r].high>=e[n].high){i=!1;break}i&&t.push({index:n,price:e[n].high});for(var a=!0,l=1;l<=5;l++)if(e[n-l].low<=e[n].low||e[n+l].low<=e[n].low){a=!1;break}a&&o.push({index:n,price:e[n].low})}for(var s=e.map(function(){return null}),c=1;c<t.length;c++){var u=t[c-1],f=t[c],b=f.index-u.index;if(!(b<this.minDistance||b>this.maxDistance)){var p=u.price*this.tolerance/100;if(!(Math.abs(u.price-f.price)>p)){for(var h=1/0,d=u.index;d<=f.index;d++)h=Math.min(h,e[d].low);for(var y=f.index+1;y<Math.min(f.index+20,e.length);y++){var m=h*(1-this.necklineBreak/100);if(e[y].close<m&&!s[y]){s[y]={type:"double_top",price:e[y].high,neckline:h};break}}}}}for(var v=1;v<o.length;v++){var k=o[v-1],g=o[v],w=g.index-k.index;if(!(w<this.minDistance||w>this.maxDistance)){var T=k.price*this.tolerance/100;if(!(Math.abs(k.price-g.price)>T)){for(var x=-1/0,D=k.index;D<=g.index;D++)x=Math.max(x,e[D].high);for(var B=g.index+1;B<Math.min(g.index+20,e.length);B++){var C=x*(1+this.necklineBreak/100);if(e[B].close>C&&!s[B]){s[B]={type:"double_bottom",price:e[B].low,neckline:x};break}}}}}this.data={signals:s}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var o=e.ctx,n=e.getDpr(),i=this.engine,r=i.data;if(this.data.signals&&this.data.signals.length===r.length||(this.calculate(),this.data&&this.data.signals)){o.save(),o.scale(n,n);for(var a=i.visibleRange,l=a.start;l<a.end;l++)if(!(l<0||l>=this.data.signals.length)){var s=this.data.signals[l];if(s){var c=i.indexToX(l)+i.candleWidth/2,u=i.priceToY(s.price);"double_top"===s.type?(this.drawDoubleTop(o,c,u),this.showLabels&&this.drawLabel(o,c,u,"DT",this.doubleTopColor)):"double_bottom"===s.type&&(this.drawDoubleBottom(o,c,u),this.showLabels&&this.drawLabel(o,c,u,"DB",this.doubleBottomColor))}}o.restore()}}}},{key:"drawDoubleTop",value:function(e,t,o){e.strokeStyle=this.doubleTopColor,e.fillStyle=this.doubleTopColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-8,o-15),e.lineTo(t-4,o-15-8),e.lineTo(t,o-15-2),e.lineTo(t+4,o-15-8),e.lineTo(t+8,o-15),e.stroke()}},{key:"drawDoubleBottom",value:function(e,t,o){e.strokeStyle=this.doubleBottomColor,e.fillStyle=this.doubleBottomColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-8,o+15),e.lineTo(t-4,o+15+8),e.lineTo(t,o+15+2),e.lineTo(t+4,o+15+8),e.lineTo(t+8,o+15),e.stroke()}},{key:"drawLabel",value:function(e,t,o,n,i){e.font="bold 9px sans-serif",e.fillStyle=i,e.textAlign="center";var r="DT"===n?-30:35;e.fillText(n,t,o+r)}}])&&i(o.prototype,n),r&&i(o,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,n,r}(o(8018).A)}}]);