"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.head-shoulders-signal"],{6006:(e,t,r)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function l(e,t,r){return t=s(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,r||[],s(e).constructor):t.apply(e,r))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}r.r(t),r.d(t,{default:()=>u});const u=function(e){function t(e,r,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,t,[e,r,i])).title="Head and Shoulders",n.shorttitle="H&S",n.precision=2,n.tolerance=void 0!==r.tolerance?r.tolerance:2,n.necklineBreak=void 0!==r.necklineBreak?r.necklineBreak:.3,n.showLabels=void 0===r.showLabels||r.showLabels,n.bearishColor=r.bearishColor||"#E91E63",n.bullishColor=r.bullishColor||"#00BCD4",n.panelType="main",n.plots=[{dataKey:"signals",colorKey:"bearishColor",title:"H&S Pattern"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),r=t,o=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"tolerance",label:"Shoulder Tolerance %",type:"number",default:2,min:.5,max:5,step:.5},{key:"necklineBreak",label:"Neckline Break %",type:"number",default:.3,min:.1,max:1,step:.1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}],style:[{key:"bearishColor",label:"Head & Shoulders",type:"color",default:"#E91E63"},{key:"bullishColor",label:"Inverse H&S",type:"color",default:"#00BCD4"}]}}}],(i=[{key:"calculate",value:function(){for(var e=this.engine.data,t=[],r=[],i=10;i<e.length-10;i++){for(var n=!0,o=1;o<=10;o++)if(e[i-o].high>=e[i].high||e[i+o].high>=e[i].high){n=!1;break}n&&t.push({index:i,price:e[i].high});for(var l=!0,a=1;a<=10;a++)if(e[i-a].low<=e[i].low||e[i+a].low<=e[i].low){l=!1;break}l&&r.push({index:i,price:e[i].low})}for(var s=e.map(function(){return null}),c=2;c<t.length;c++){var u=t[c-2],h=t[c-1],f=t[c];if(!(h.price<=u.price||h.price<=f.price||Math.abs(u.price-f.price)>u.price*this.tolerance/100)){for(var p=1/0,d=u.index;d<=f.index;d++)p=Math.min(p,e[d].low);for(var b=f.index+1;b<Math.min(f.index+20,e.length);b++){var y=p*(1-this.necklineBreak/100);if(e[b].close<y&&!s[b]){s[b]={type:"head_shoulders",price:e[b].high,neckline:p};break}}}}for(var v=2;v<r.length;v++){var g=r[v-2],k=r[v-1],w=r[v];if(!(k.price>=g.price||k.price>=w.price||Math.abs(g.price-w.price)>g.price*this.tolerance/100)){for(var m=-1/0,S=g.index;S<=w.index;S++)m=Math.max(m,e[S].high);for(var x=w.index+1;x<Math.min(w.index+20,e.length);x++){var C=m*(1+this.necklineBreak/100);if(e[x].close>C&&!s[x]){s[x]={type:"inverse_head_shoulders",price:e[x].low,neckline:m};break}}}}this.data={signals:s}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var r=e.ctx,i=e.getDpr(),n=this.engine,o=n.data;if(this.data.signals&&this.data.signals.length===o.length||(this.calculate(),this.data&&this.data.signals)){r.save(),r.scale(i,i);for(var l=n.visibleRange,a=l.start;a<l.end;a++)if(!(a<0||a>=this.data.signals.length)){var s=this.data.signals[a];if(s){var c=n.indexToX(a)+n.candleWidth/2,u=n.priceToY(s.price);"head_shoulders"===s.type?(this.drawHeadShoulders(r,c,u),this.showLabels&&this.drawLabel(r,c,u,"H&S",this.bearishColor)):"inverse_head_shoulders"===s.type&&(this.drawInverseHeadShoulders(r,c,u),this.showLabels&&this.drawLabel(r,c,u,"iH&S",this.bullishColor))}}r.restore()}}}},{key:"drawHeadShoulders",value:function(e,t,r){e.strokeStyle=this.bearishColor,e.fillStyle=this.bearishColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-12,r-15-6),e.lineTo(t-6,r-15-2),e.lineTo(t,r-15-10),e.lineTo(t+6,r-15-2),e.lineTo(t+12,r-15-6),e.stroke()}},{key:"drawInverseHeadShoulders",value:function(e,t,r){e.strokeStyle=this.bullishColor,e.fillStyle=this.bullishColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-12,r+15+6),e.lineTo(t-6,r+15+2),e.lineTo(t,r+15+10),e.lineTo(t+6,r+15+2),e.lineTo(t+12,r+15+6),e.stroke()}},{key:"drawLabel",value:function(e,t,r,i,n){e.font="bold 9px sans-serif",e.fillStyle=n,e.textAlign="center";var o="H&S"===i?-30:35;e.fillText(i,t,r+o)}}])&&n(r.prototype,i),o&&n(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(r(8018).A)}}]);