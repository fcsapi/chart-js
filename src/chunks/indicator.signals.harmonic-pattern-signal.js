"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.signals.harmonic-pattern-signal"],{124:(e,t,i)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return o(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==i.return||i.return()}finally{if(s)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,i){return t=u(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,c()?Reflect.construct(t,i||[],u(e).constructor):t.apply(e,i))}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(c=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}i.r(t),i.d(t,{default:()=>h});const h=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=s(this,t,[e,i,r])).title="Harmonic Pattern",n.shorttitle="Harmonic",n.precision=2,n.fibTolerance=void 0!==i.fibTolerance?i.fibTolerance:5,n.minSwingSize=void 0!==i.minSwingSize?i.minSwingSize:1,n.showLabels=void 0===i.showLabels||i.showLabels,n.bullishColor=i.bullishColor||"#00E676",n.bearishColor=i.bearishColor||"#FF1744",n.panelType="main",n.plots=[{dataKey:"signals",colorKey:"bullishColor",title:"Harmonic Pattern"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),i=t,o=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"fibTolerance",label:"Fib Tolerance %",type:"number",default:5,min:2,max:10,step:1},{key:"minSwingSize",label:"Min Swing Size %",type:"number",default:1,min:.5,max:3,step:.5},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}],style:[{key:"bullishColor",label:"Bullish Gartley",type:"color",default:"#00E676"},{key:"bearishColor",label:"Bearish Gartley",type:"color",default:"#FF1744"}]}}}],(r=[{key:"calculate",value:function(){for(var e=this.engine.data,t=this.findSwingPoints(e,!0),i=this.findSwingPoints(e,!1),r=e.map(function(){return null}),n=4;n<i.length;n++){var o=i[n-4],a=i[n-2],l=i[n],s=this.findHighBetween(t,o.index,a.index),c=this.findHighBetween(t,a.index,l.index);s&&c&&this.isBullishGartley(o,s,a,c,l)&&(r[l.index]||(r[l.index]={type:"bullish",price:l.price,pattern:"Gartley"}))}for(var u=4;u<t.length;u++){var f=t[u-4],h=t[u-2],b=t[u],y=this.findLowBetween(i,f.index,h.index),p=this.findLowBetween(i,h.index,b.index);y&&p&&this.isBearishGartley(f,y,h,p,b)&&(r[b.index]||(r[b.index]={type:"bearish",price:b.price,pattern:"Gartley"}))}this.data={signals:r}}},{key:"findSwingPoints",value:function(e,t){for(var i=[],r=5;r<e.length-5;r++){for(var n=!0,o=1;o<=5;o++)if(t){if(e[r-o].high>=e[r].high||e[r+o].high>=e[r].high){n=!1;break}}else if(e[r-o].low<=e[r].low||e[r+o].low<=e[r].low){n=!1;break}n&&i.push({index:r,price:t?e[r].high:e[r].low})}return i}},{key:"findHighBetween",value:function(e,t,i){var r,o=n(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.index>t&&a.index<i)return a}}catch(l){o.e(l)}finally{o.f()}return null}},{key:"findLowBetween",value:function(e,t,i){var r,o=n(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.index>t&&a.index<i)return a}}catch(l){o.e(l)}finally{o.f()}return null}},{key:"isBullishGartley",value:function(e,t,i,r,n){var o=Math.abs(t.price-e.price),a=Math.abs(i.price-t.price),l=Math.abs(r.price-i.price),s=Math.abs(n.price-r.price),c=e.price*this.minSwingSize/100;if(o<c||a<c||l<c||s<c)return!1;var u=a/o*100,f=l/a*100,h=(t.price-n.price)/o*100;return!(!this.checkRatio(u,61.8,this.fibTolerance)||f<38.2-this.fibTolerance||f>88.6+this.fibTolerance||!this.checkRatio(h,78.6,this.fibTolerance))}},{key:"isBearishGartley",value:function(e,t,i,r,n){var o=Math.abs(t.price-e.price),a=Math.abs(i.price-t.price),l=Math.abs(r.price-i.price),s=Math.abs(n.price-r.price),c=e.price*this.minSwingSize/100;if(o<c||a<c||l<c||s<c)return!1;var u=a/o*100,f=l/a*100,h=(n.price-t.price)/o*100;return!(!this.checkRatio(u,61.8,this.fibTolerance)||f<38.2-this.fibTolerance||f>88.6+this.fibTolerance||!this.checkRatio(h,78.6,this.fibTolerance))}},{key:"checkRatio",value:function(e,t,i){return e>=t-i&&e<=t+i}},{key:"render",value:function(e,t){if(this.visible&&this.data){var i=e.ctx,r=e.getDpr(),n=this.engine,o=n.data;if(this.data.signals&&this.data.signals.length===o.length||(this.calculate(),this.data&&this.data.signals)){i.save(),i.scale(r,r);for(var a=n.visibleRange,l=a.start;l<a.end;l++)if(!(l<0||l>=this.data.signals.length)){var s=this.data.signals[l];if(s){var c=n.indexToX(l)+n.candleWidth/2,u=n.priceToY(s.price);"bullish"===s.type?(this.drawBullishGartley(i,c,u),this.showLabels&&this.drawLabel(i,c,u,"GRTL↑",this.bullishColor)):"bearish"===s.type&&(this.drawBearishGartley(i,c,u),this.showLabels&&this.drawLabel(i,c,u,"GRTL↓",this.bearishColor))}}i.restore()}}}},{key:"drawBullishGartley",value:function(e,t,i){var r=20;e.strokeStyle=this.bullishColor,e.fillStyle=this.bullishColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-12,i+r+8),e.lineTo(t-6,i+r),e.lineTo(t,i+r+4),e.lineTo(t+6,i+r+2),e.lineTo(t+12,i+r+6),e.stroke(),e.beginPath(),e.arc(t+12,i+r+6,3,0,2*Math.PI),e.fill()}},{key:"drawBearishGartley",value:function(e,t,i){var r=20;e.strokeStyle=this.bearishColor,e.fillStyle=this.bearishColor,e.lineWidth=2,e.beginPath(),e.moveTo(t-12,i-r-8),e.lineTo(t-6,i-r),e.lineTo(t,i-r-4),e.lineTo(t+6,i-r-2),e.lineTo(t+12,i-r-6),e.stroke(),e.beginPath(),e.arc(t+12,i-r-6,3,0,2*Math.PI),e.fill()}},{key:"drawLabel",value:function(e,t,i,r,n){e.font="bold 9px sans-serif",e.fillStyle=n,e.textAlign="center";var o=r.includes("↑")?40:-35;e.fillText(r,t,i+o)}}])&&a(i.prototype,r),o&&a(i,o),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,o}(i(8018).A)}}]);