"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.technicals.supertrend"],{1470:(e,t,l)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var l=0;l<t.length;l++){var i=t[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function r(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var n=l.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function o(e,t,l){return t=s(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,l||[],s(e).constructor):t.apply(e,l))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}l.r(t),l.d(t,{default:()=>c});const c=function(e){function t(e,l,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=o(this,t,[e,l,i])).title="Supertrend",n.shorttitle="ST",n.precision=2,n.atrPeriod=void 0!==l.atrPeriod?l.atrPeriod:10,n.multiplier=void 0!==l.multiplier?l.multiplier:3,n.src=void 0!==l.src?l.src:"hl2",n.linewidth=void 0!==l.linewidth?l.linewidth:2,n.uptrendColor=l.uptrendColor||"#26A69A",n.downtrendColor=l.downtrendColor||"#EF5350",n.showSignals=void 0===l.showSignals||l.showSignals,n.buySignalColor=l.buySignalColor||"#26A69A",n.sellSignalColor=l.sellSignalColor||"#EF5350",n.signalSize=void 0!==l.signalSize?l.signalSize:4,n.showLabels=void 0===l.showLabels||l.showLabels,n.panelType="main",n.panelHeight=150,n.plots=[{dataKey:"supertrend",colorKey:"uptrendColor",title:"Supertrend"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(t,e),l=t,r=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"atrPeriod",label:"ATR Period",type:"number",default:10,min:1,max:500,step:1},{key:"multiplier",label:"ATR Multiplier",type:"number",default:3,min:.1,max:10,step:.1},{key:"src",label:"Source",type:"select",default:"hl2",options:["close","hl2","hlc3","ohlc4"]},{key:"linewidth",label:"Line Width",type:"number",default:2,min:1,max:5,step:1}],style:[{key:"uptrendColor",label:"Up Trend",type:"color",default:"#26A69A"},{key:"downtrendColor",label:"Down Trend",type:"color",default:"#EF5350"},{key:"showSignals",label:"Show Buy/Sell Signals",type:"checkbox",default:!0},{key:"buySignalColor",label:"Buy Signal",type:"color",default:"#26A69A"},{key:"sellSignalColor",label:"Sell Signal",type:"color",default:"#EF5350"},{key:"signalSize",label:"Signal Size",type:"number",default:4,min:2,max:10,step:1},{key:"showLabels",label:"Show Labels",type:"checkbox",default:!0}]}}}],(i=[{key:"calculate",value:function(){var e=this,t=this.engine.data,l=this.engine.dataManager;if(t&&0!==t.length){for(var i=t.map(function(t){switch(e.src){case"hl2":return(t.high+t.low)/2;case"hlc3":return(t.high+t.low+t.close)/3;case"ohlc4":return(t.open+t.high+t.low+t.close)/4;default:return t.close}}),n=l.calculateATR(t,this.atrPeriod),r=[],o=[],a=0;a<t.length;a++)null!==n[a]&&void 0!==n[a]?(r[a]=i[a]+this.multiplier*n[a],o[a]=i[a]-this.multiplier*n[a]):(r[a]=null,o[a]=null);for(var s=[],u=[],c=0;c<t.length;c++)null!==r[c]&&null!==o[c]?(s[c]=0===c||r[c]<s[c-1]||t[c-1].close>s[c-1]?r[c]:s[c-1],u[c]=0===c||o[c]>u[c-1]||t[c-1].close<u[c-1]?o[c]:u[c-1]):(s[c]=null,u[c]=null);for(var d=[],h=[],f=[],p=0;p<t.length;p++)null!==s[p]&&null!==u[p]?0===p?(h[p]=1,d[p]=u[p],f[p]=0):1===h[p-1]?t[p].close<=u[p]?(h[p]=-1,d[p]=s[p],f[p]=-1):(h[p]=1,d[p]=u[p],f[p]=0):t[p].close>=s[p]?(h[p]=1,d[p]=u[p],f[p]=1):(h[p]=-1,d[p]=s[p],f[p]=0):(d[p]=null,h[p]=null,f[p]=0);this.data={supertrend:d,direction:h,signals:f,finalUpperBand:s,finalLowerBand:u}}}},{key:"render",value:function(e,t){if(this.visible&&this.data){var l=e.ctx,i=e.getDpr(),n=this.engine,r=n.data;(this.data.supertrend&&this.data.supertrend.length===r.length||(this.calculate(),this.data&&this.data.supertrend))&&(l.save(),l.scale(i,i),this.drawSupertrendLine(l,n),this.showSignals&&this.drawSignals(l,n),this.showLabels&&this.drawLabels(l,n,i),l.restore())}}},{key:"drawSupertrendLine",value:function(e,t){for(var l=t.visibleRange,i=Math.max(0,l.start),n=Math.min(this.data.supertrend.length,l.end),r=i;r<n-1;r++){var o=this.data.supertrend[r],a=this.data.supertrend[r+1],s=this.data.direction[r],u=this.data.direction[r+1];if(null!==o&&null!==a&&null!==s&&null!==u){var c=t.indexToX(r)+t.candleWidth/2,d=t.priceToY(o),h=t.indexToX(r+1)+t.candleWidth/2,f=t.priceToY(a);e.strokeStyle=1===s?this.uptrendColor:this.downtrendColor,e.lineWidth=this.linewidth,e.beginPath(),e.moveTo(c,d),e.lineTo(h,f),e.stroke()}}}},{key:"drawSignals",value:function(e,t){for(var l=t.visibleRange,i=Math.max(0,l.start),n=Math.min(this.data.signals.length,l.end),r=i;r<n;r++){var o=this.data.signals[r];if(0!==o){var a=t.indexToX(r)+t.candleWidth/2,s=this.data.supertrend[r];if(null!==s){var u=t.priceToY(s);if(e.beginPath(),1===o?(e.fillStyle=this.buySignalColor,e.arc(a,u+2*this.signalSize,this.signalSize,0,2*Math.PI)):(e.fillStyle=this.sellSignalColor,e.arc(a,u-2*this.signalSize,this.signalSize,0,2*Math.PI)),e.fill(),1===o){var c=1.5*this.signalSize,d=3.5*this.signalSize;e.fillStyle=this.buySignalColor,e.beginPath(),e.moveTo(a,u+d),e.lineTo(a-c,u+d+c),e.lineTo(a+c,u+d+c),e.closePath(),e.fill()}else{var h=1.5*this.signalSize,f=3.5*this.signalSize;e.fillStyle=this.sellSignalColor,e.beginPath(),e.moveTo(a,u-f),e.lineTo(a-h,u-f-h),e.lineTo(a+h,u-f-h),e.closePath(),e.fill()}}}}}},{key:"drawLabels",value:function(e,t,l){e.fillStyle="#d1d4dc",e.font="bold 11px sans-serif";var i=this.shorttitle;e.fillText(i,5,12);var n=t.visibleRange.end-1;if(void 0!==t.hoveredIndex&&null!==t.hoveredIndex&&(n=t.hoveredIndex),n>=0&&n<this.data.supertrend.length){var r=this.data.supertrend[n],o=this.data.direction[n];if(null!=r&&null!==o){e.font="11px sans-serif";var a=5+e.measureText(i).width+10;e.fillStyle=1===o?this.uptrendColor:this.downtrendColor;var s=1===o?"UP":"DOWN",u="".concat(r.toFixed(this.precision)," [").concat(s,"]");e.fillText(u,a,12)}}}}])&&n(l.prototype,i),r&&n(l,r),Object.defineProperty(l,"prototype",{writable:!1}),l;var l,i,r}(l(8018).A)}}]);