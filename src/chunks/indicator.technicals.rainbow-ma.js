"use strict";(self.webpackChunkfcsapi_chart=self.webpackChunkfcsapi_chart||[]).push([["indicator.technicals.rainbow-ma"],{275:(e,t,a)=>{function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function i(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,o(l.key),l)}}function o(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}function r(e,t,a){return t=c(t),function(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,n()?Reflect.construct(t,a||[],c(e).constructor):t.apply(e,a))}function n(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(n=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}a.r(t),a.d(t,{default:()=>m});const m=function(e){function t(e,a,l){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=r(this,t,[e,a,l])).title="Rainbow Moving Average",i.shorttitle="Rainbow MA",i.precision=2,i.maType=void 0!==a.maType?a.maType:"SMA",i.src=void 0!==a.src?a.src:"close",i.linewidth=void 0!==a.linewidth?a.linewidth:1,i.ma1Length=void 0!==a.ma1Length?a.ma1Length:8,i.ma2Length=void 0!==a.ma2Length?a.ma2Length:13,i.ma3Length=void 0!==a.ma3Length?a.ma3Length:21,i.ma4Length=void 0!==a.ma4Length?a.ma4Length:34,i.ma5Length=void 0!==a.ma5Length?a.ma5Length:55,i.ma6Length=void 0!==a.ma6Length?a.ma6Length:89,i.ma7Length=void 0!==a.ma7Length?a.ma7Length:144,i.ma8Length=void 0!==a.ma8Length?a.ma8Length:233,i.defaultColors=["#FF0000","#FF7F00","#FFFF00","#00FF00","#00FFFF","#0080FF","#0000FF","#8000FF"],i.ma1Color=a.ma1Color||i.defaultColors[0],i.ma1Visible=void 0===a.ma1Visible||a.ma1Visible,i.ma2Color=a.ma2Color||i.defaultColors[1],i.ma2Visible=void 0===a.ma2Visible||a.ma2Visible,i.ma3Color=a.ma3Color||i.defaultColors[2],i.ma3Visible=void 0===a.ma3Visible||a.ma3Visible,i.ma4Color=a.ma4Color||i.defaultColors[3],i.ma4Visible=void 0===a.ma4Visible||a.ma4Visible,i.ma5Color=a.ma5Color||i.defaultColors[4],i.ma5Visible=void 0===a.ma5Visible||a.ma5Visible,i.ma6Color=a.ma6Color||i.defaultColors[5],i.ma6Visible=void 0===a.ma6Visible||a.ma6Visible,i.ma7Color=a.ma7Color||i.defaultColors[6],i.ma7Visible=void 0===a.ma7Visible||a.ma7Visible,i.ma8Color=a.ma8Color||i.defaultColors[7],i.ma8Visible=void 0===a.ma8Visible||a.ma8Visible,i.fillVisible=void 0===a.fillVisible||a.fillVisible,i.fillOpacity=void 0!==a.fillOpacity?a.fillOpacity:.05,i.panelType="main",i.panelHeight=150,i.plots=[{dataKey:"ma1",colorKey:"ma1Color",title:"MA1"},{dataKey:"ma2",colorKey:"ma2Color",title:"MA2"},{dataKey:"ma3",colorKey:"ma3Color",title:"MA3"},{dataKey:"ma4",colorKey:"ma4Color",title:"MA4"},{dataKey:"ma5",colorKey:"ma5Color",title:"MA5"},{dataKey:"ma6",colorKey:"ma6Color",title:"MA6"},{dataKey:"ma7",colorKey:"ma7Color",title:"MA7"},{dataKey:"ma8",colorKey:"ma8Color",title:"MA8"}],i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(t,e),a=t,o=[{key:"getSettingsConfig",value:function(){return{inputs:[{key:"maType",label:"MA Type",type:"select",default:"SMA",options:["SMA","EMA","WMA","HMA"]},{key:"src",label:"Source",type:"source",default:"close"},{key:"ma1Length",label:"MA 1 Length",type:"number",default:8,min:1,max:500,step:1},{key:"ma2Length",label:"MA 2 Length",type:"number",default:13,min:1,max:500,step:1},{key:"ma3Length",label:"MA 3 Length",type:"number",default:21,min:1,max:500,step:1},{key:"ma4Length",label:"MA 4 Length",type:"number",default:34,min:1,max:500,step:1},{key:"ma5Length",label:"MA 5 Length",type:"number",default:55,min:1,max:500,step:1},{key:"ma6Length",label:"MA 6 Length",type:"number",default:89,min:1,max:500,step:1},{key:"ma7Length",label:"MA 7 Length",type:"number",default:144,min:1,max:500,step:1},{key:"ma8Length",label:"MA 8 Length",type:"number",default:233,min:1,max:500,step:1},{key:"linewidth",label:"Line Width",type:"number",default:1,min:1,max:5,step:1}],style:[{key:"ma1Color",label:"MA 1",type:"color",default:"#FF0000"},{key:"ma1Visible",label:"MA 1",type:"checkbox",default:!0},{key:"ma2Color",label:"MA 2",type:"color",default:"#FF7F00"},{key:"ma2Visible",label:"MA 2",type:"checkbox",default:!0},{key:"ma3Color",label:"MA 3",type:"color",default:"#FFFF00"},{key:"ma3Visible",label:"MA 3",type:"checkbox",default:!0},{key:"ma4Color",label:"MA 4",type:"color",default:"#00FF00"},{key:"ma4Visible",label:"MA 4",type:"checkbox",default:!0},{key:"ma5Color",label:"MA 5",type:"color",default:"#00FFFF"},{key:"ma5Visible",label:"MA 5",type:"checkbox",default:!0},{key:"ma6Color",label:"MA 6",type:"color",default:"#0080FF"},{key:"ma6Visible",label:"MA 6",type:"checkbox",default:!0},{key:"ma7Color",label:"MA 7",type:"color",default:"#0000FF"},{key:"ma7Visible",label:"MA 7",type:"checkbox",default:!0},{key:"ma8Color",label:"MA 8",type:"color",default:"#8000FF"},{key:"ma8Visible",label:"MA 8",type:"checkbox",default:!0},{key:"fillVisible",label:"Fill Background",type:"checkbox",default:!0},{key:"fillOpacity",label:"Fill Opacity",type:"number",default:.05,min:0,max:1,step:.05}]}}}],(l=[{key:"calculate",value:function(){var e=this,t=this.engine.data,a=this.engine.dataManager,l=t.map(function(t){return t[e.src]}),i=function(t){switch(e.maType){case"EMA":return a.calculateEMAFromArray(l,t);case"WMA":return e.calculateWMA(l,t);case"HMA":return e.calculateHMA(l,t);default:return a.calculateSMAFromArray(l,t)}};this.data={ma1:i(this.ma1Length),ma2:i(this.ma2Length),ma3:i(this.ma3Length),ma4:i(this.ma4Length),ma5:i(this.ma5Length),ma6:i(this.ma6Length),ma7:i(this.ma7Length),ma8:i(this.ma8Length)}}},{key:"calculateWMA",value:function(e,t){for(var a=[],l=0,i=1;i<=t;i++)a.push(i),l+=i;return e.map(function(i,o){if(o<t-1)return null;for(var r=0,n=0;n<t;n++)r+=e[o-t+1+n]*a[n];return r/l})}},{key:"calculateHMA",value:function(e,t){this.engine.dataManager;var a=Math.floor(t/2),l=Math.floor(Math.sqrt(t)),i=this.calculateWMA(e,a),o=this.calculateWMA(e,t),r=i.map(function(e,t){return null===e||null===o[t]?null:2*e-o[t]});return this.calculateWMA(r.map(function(e){return null===e?0:e}),l)}},{key:"render",value:function(e,t){if(this.visible&&this.data){var a=e.ctx,l=e.getDpr(),i=this.engine,o=i.data;if(this.data.ma1&&this.data.ma1.length===o.length||(this.calculate(),this.data&&this.data.ma1)){if(a.save(),a.scale(l,l),this.fillVisible)for(var r=0;r<7;r++){var n="ma".concat(r+1),c="ma".concat(r+2),s="ma".concat(r+1,"Color");this.data[n]&&this.data[c]&&this["".concat(n,"Visible")]&&this["".concat(c,"Visible")]&&this.drawFillBetweenLines(a,this.data[n],this.data[c],this[s],i)}for(var m=[{key:"ma1",color:this.ma1Color,visible:this.ma1Visible,label:"MA".concat(this.ma1Length)},{key:"ma2",color:this.ma2Color,visible:this.ma2Visible,label:"MA".concat(this.ma2Length)},{key:"ma3",color:this.ma3Color,visible:this.ma3Visible,label:"MA".concat(this.ma3Length)},{key:"ma4",color:this.ma4Color,visible:this.ma4Visible,label:"MA".concat(this.ma4Length)},{key:"ma5",color:this.ma5Color,visible:this.ma5Visible,label:"MA".concat(this.ma5Length)},{key:"ma6",color:this.ma6Color,visible:this.ma6Visible,label:"MA".concat(this.ma6Length)},{key:"ma7",color:this.ma7Color,visible:this.ma7Visible,label:"MA".concat(this.ma7Length)},{key:"ma8",color:this.ma8Color,visible:this.ma8Visible,label:"MA".concat(this.ma8Length)}],u=0;u<8;u++){var h=m[u];h.visible&&this.data[h.key]&&this.drawLine(a,this.data[h.key],!0,h.color,this.linewidth,0,0,i,t)}a.restore()}}}},{key:"drawLine",value:function(e,t,a,l,i,o,r,n,c){if(t&&0!==t.length){var s=n.visibleRange,m=Math.max(0,s.start),u=Math.min(t.length,s.end),h=t.slice(m,u),b=m-s.start;e.strokeStyle=l,e.lineWidth=i,e.beginPath();var y=!1;h.forEach(function(t,a){if(null!==t&&!isNaN(t)){var l=s.start+b+a,i=n.indexToX(l)+n.candleWidth/2,o=n.priceToY(t);y?e.lineTo(i,o):(e.moveTo(i,o),y=!0)}}),e.stroke()}}},{key:"drawFillBetweenLines",value:function(e,t,a,l,i){if(t&&a&&0!==t.length&&0!==a.length){var o=i.visibleRange,r=Math.max(0,o.start),n=Math.min(t.length,o.end),c=r-o.start,s=this.applyOpacityToColor(l,this.fillOpacity);e.fillStyle=s,e.beginPath();for(var m=!1,u=r;u<n;u++){var h=t[u];if(null!==h&&!isNaN(h)){var b=o.start+c+(u-r),y=i.indexToX(b)+i.candleWidth/2,f=i.priceToY(h);m?e.lineTo(y,f):(e.moveTo(y,f),m=!0)}}for(var d=n-1;d>=r;d--){var p=a[d];if(null!==p&&!isNaN(p)){var g=o.start+c+(d-r),v=i.indexToX(g)+i.candleWidth/2,M=i.priceToY(p);e.lineTo(v,M)}}e.closePath(),e.fill()}}},{key:"applyOpacityToColor",value:function(e,t){if(e.startsWith("#")){var a=parseInt(e.slice(1,3),16),l=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return"rgba(".concat(a,", ").concat(l,", ").concat(i,", ").concat(t,")")}return e.startsWith("rgba")?e.replace(/[\d.]+\)$/g,"".concat(t,")")):e.startsWith("rgb")?e.replace("rgb","rgba").replace(")",", ".concat(t,")")):e}}])&&i(a.prototype,l),o&&i(a,o),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,l,o}(a(8018).A)}}]);